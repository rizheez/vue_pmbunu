import{_ as B,a as F}from"./index-C1Ft3s5T.js";import{_ as P}from"./AlertTitle.vue_vue_type_script_setup_true_lang-BSLCEp3t.js";import{a as Q,_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-DinLlKE5.js";import{_}from"./index-UEfTj4wh.js";import{_ as S,a as tt,b as et,c as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3mlPz-I.js";import{_ as I,a as L,b as N,c as A}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BQo5Yl-l.js";import{_ as st}from"./DialogDescription.vue_vue_type_script_setup_true_lang-silKCfmM.js";import{_ as at}from"./DialogFooter.vue_vue_type_script_setup_true_lang-D-0ZZbjn.js";import{_ as lt}from"./Label.vue_vue_type_script_setup_true_lang-YPxoaBcV.js";import{_ as nt}from"./Textarea.vue_vue_type_script_setup_true_lang-BrVgN6wK.js";import{f as ot}from"./useFormat-CGBiKtzC.js";import{d as it,j as dt,c as K,p as f,a as c,e as s,u as e,h as rt,w as n,b as a,k as y,i as h,o as r,f as d,t as u,l as ut,F as E,r as mt,n as ct,s as ft}from"./app-D5OcARYv.js";import{C as U,F as M}from"./file-text-CV_xxGPM.js";import{C as pt}from"./circle-alert-CnAyYh6d.js";import{A as _t}from"./arrow-left-BkTkWMO5.js";import{C as vt}from"./check-DrZNu8iJ.js";import{c as gt}from"./createLucideIcon-x21i96bS.js";import{E as bt}from"./eye-BZqzdpIM.js";import{C as kt}from"./circle-x-D2BRpvpn.js";import"./VisuallyHidden-uWdxpz0q.js";import"./index-Bo1-g3F-.js";import"./triangle-alert-BmIPATx-.js";import"./ChatWidget.vue_vue_type_script_setup_true_lang-lf1i5k0i.js";import"./index-CMWG4mbA.js";import"./loader-circle-DhjY_-Pi.js";import"./useForwardExpose-CO2v1_2r.js";import"./useForwardPropsEmits-Dl70jCDi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-plus-LeFNbwb6.js";const xt=gt("FileImageIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),yt={class:"flex flex-col gap-6 p-4"},ht={class:"flex items-center justify-between"},Ct={class:"flex items-center gap-4"},wt={class:"text-sm text-gray-500"},$t={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},zt={class:"flex items-center justify-between"},jt={key:0,class:"rounded-lg border bg-gray-50 p-4 text-sm"},Dt={class:"grid gap-3"},Vt={class:"font-medium"},Bt={class:"grid grid-cols-2 gap-2"},Ft={class:"font-mono font-medium"},Pt={class:"font-mono font-medium"},St={class:"grid grid-cols-2 gap-2"},Tt={class:"font-medium"},It={class:"font-medium"},Lt={class:"font-medium"},Nt=["onClick"],At={key:0,class:"flex size-full flex-col items-center justify-center gap-2 bg-gray-50 text-gray-500 transition hover:bg-gray-100"},Kt=["src","alt"],Et={class:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 transition hover:opacity-100"},Ut={key:2,class:"flex aspect-video items-center justify-center rounded-lg border bg-gray-50"},Mt={key:3,class:"rounded-md border border-red-200 bg-red-50 p-2"},Rt={class:"text-xs text-red-600"},qt={class:"flex gap-2"},Ot={class:"mt-2 max-w-full flex-1 overflow-hidden rounded-lg bg-gray-100"},Wt=["src"],Ht=["src","alt"],Xt={class:"space-y-4 py-4"},Zt={class:"space-y-2"},ze=it({__name:"Documents",props:{student:{}},setup(R){const i=R,q=dt(),g=K(()=>q.props.flash),C=f(!1),v=f(!1),w=f(!1),b=f(""),$=f(""),k=f(null),p=f(""),m=f({});(()=>{i.student.student_biodata?.verifications&&i.student.student_biodata.verifications.forEach(o=>{m.value[o.id]={status:o.status,notes:o.notes||""}})})();const O=[{title:"Admin Dashboard",href:"/admin/dashboard"},{title:"Calon Mahasiswa",href:"/admin/students"},{title:i.student.student_biodata?.name||i.student.name,href:`/admin/students/${i.student.hashed_id}`},{title:"Verifikasi Dokumen",href:"#"}],z={photo:"Pas Foto",ktp:"KTP",kk:"Kartu Keluarga",certificate:"Ijazah/SKL",biodata:"Biodata Diri"},x=o=>{const t=i.student.student_biodata;return t&&{photo:t.photo_url,ktp:t.ktp_url,kk:t.kk_url,certificate:t.certificate_url}[o]||null},j=o=>({pending:{variant:"outline",label:"Pending",class:"text-yellow-600 border-yellow-300"},approved:{variant:"default",label:"Disetujui",class:"bg-green-600"},rejected:{variant:"destructive",label:"Ditolak",class:""}})[o]||{variant:"secondary",label:"Unknown",class:""},W=(o,t)=>{b.value=o,$.value=t,w.value=!0},H=o=>{k.value=o,p.value=m.value[o]?.notes||"",v.value=!0},X=()=>{k.value&&(m.value[k.value]={status:"rejected",notes:p.value}),v.value=!1,k.value=null,p.value=""},Z=o=>{m.value[o]={status:"approved",notes:""}},G=()=>{const o=Object.entries(m.value).filter(t=>{const[,l]=t;return l.status!=="pending"}).map(([t,l])=>({id:parseInt(t),status:l.status,notes:l.notes}));if(o.length===0){alert("Pilih status verifikasi untuk minimal 1 dokumen");return}C.value=!0,ft.post(`/admin/students/${i.student.hashed_id}/documents/bulk-verify`,{verifications:o},{onFinish:()=>{C.value=!1}})},D=o=>o.toLowerCase().endsWith(".pdf")||o.startsWith("data:application/pdf"),J=K(()=>Object.values(m.value).some(o=>o.status!=="pending"));return(o,t)=>(r(),c(E,null,[s(e(rt),{title:`Verifikasi Dokumen - ${i.student.name}`},null,8,["title"]),s(Y,{breadcrumbs:O},{default:n(()=>[a("div",yt,[g.value?.success?(r(),y(e(B),{key:0,class:"border-green-500 bg-green-50"},{default:n(()=>[s(e(U),{class:"size-4 text-green-600"}),s(e(P),{class:"text-green-800"},{default:n(()=>[...t[4]||(t[4]=[d("Berhasil",-1)])]),_:1}),s(e(F),{class:"text-green-700"},{default:n(()=>[d(u(g.value.success),1)]),_:1})]),_:1})):h("",!0),g.value?.error?(r(),y(e(B),{key:1,variant:"destructive"},{default:n(()=>[s(e(pt),{class:"size-4"}),s(e(P),null,{default:n(()=>[...t[5]||(t[5]=[d("Error",-1)])]),_:1}),s(e(F),null,{default:n(()=>[d(u(g.value.error),1)]),_:1})]),_:1})):h("",!0),a("div",ht,[a("div",Ct,[s(e(_),{variant:"ghost",size:"sm","as-child":""},{default:n(()=>[s(e(ut),{href:`/admin/students/${i.student.hashed_id}`},{default:n(()=>[s(e(_t),{class:"mr-2 size-4"}),t[6]||(t[6]=d(" Kembali ",-1))]),_:1},8,["href"])]),_:1}),a("div",null,[t[7]||(t[7]=a("h1",{class:"text-2xl font-bold"},"Verifikasi Dokumen",-1)),a("p",wt,u(i.student.student_biodata?.name||i.student.name),1)])]),s(e(_),{onClick:G,disabled:!J.value||C.value,class:"bg-teal-600 hover:bg-teal-700"},{default:n(()=>[s(e(vt),{class:"mr-2 size-4"}),t[8]||(t[8]=d(" Simpan Verifikasi ",-1))]),_:1},8,["disabled"])]),a("div",$t,[(r(!0),c(E,null,mt(i.student.student_biodata?.verifications,l=>(r(),y(e(S),{key:l.id},{default:n(()=>[s(e(tt),{class:"pb-3"},{default:n(()=>[a("div",zt,[s(e(et),{class:"flex items-center gap-2 text-base"},{default:n(()=>[s(e(xt),{class:"size-4"}),d(" "+u(z[l.document_type]||l.document_type),1)]),_:2},1024),s(e(Q),{variant:j(m.value[l.id]?.status||l.status).variant,class:ct(j(m.value[l.id]?.status||l.status).class)},{default:n(()=>[d(u(j(m.value[l.id]?.status||l.status).label),1)]),_:2},1032,["variant","class"])])]),_:2},1024),s(e(T),{class:"space-y-4"},{default:n(()=>[l.document_type==="biodata"?(r(),c("div",jt,[a("div",Dt,[a("div",null,[t[9]||(t[9]=a("span",{class:"text-xs text-gray-500"},"Nama Lengkap",-1)),a("p",Vt,u(i.student.student_biodata?.name),1)]),a("div",Bt,[a("div",null,[t[10]||(t[10]=a("span",{class:"text-xs text-gray-500"},"NIK",-1)),a("p",Ft,u(i.student.student_biodata?.nik),1)]),a("div",null,[t[11]||(t[11]=a("span",{class:"text-xs text-gray-500"},"NISN",-1)),a("p",Pt,u(i.student.student_biodata?.nisn||"-"),1)])]),a("div",St,[a("div",null,[t[12]||(t[12]=a("span",{class:"text-xs text-gray-500"},"Tempat, Tgl Lahir",-1)),a("p",Tt,u(i.student.student_biodata?.birth_place)+", "+u(e(ot)(i.student.student_biodata?.birth_date)),1)]),a("div",null,[t[13]||(t[13]=a("span",{class:"text-xs text-gray-500"},"Agama",-1)),a("p",It,u(i.student.student_biodata?.religion),1)])]),a("div",null,[t[14]||(t[14]=a("span",{class:"text-xs text-gray-500"},"Asal Sekolah",-1)),a("p",Lt,u(i.student.student_biodata?.school_origin),1)])])])):x(l.document_type)?(r(),c("div",{key:1,class:"relative aspect-video cursor-pointer overflow-hidden rounded-lg border bg-gray-100",onClick:V=>W(x(l.document_type),z[l.document_type])},[D(x(l.document_type))?(r(),c("div",At,[s(e(M),{class:"size-12 text-red-500"}),t[15]||(t[15]=a("span",{class:"text-xs font-medium"},"Dokumen PDF",-1))])):(r(),c("img",{key:1,src:x(l.document_type),alt:z[l.document_type],class:"size-full object-cover transition hover:scale-105"},null,8,Kt)),a("div",Et,[s(e(bt),{class:"size-8 text-white"})])],8,Nt)):(r(),c("div",Ut,[...t[16]||(t[16]=[a("p",{class:"text-sm text-gray-400"},"Tidak ada file",-1)])])),m.value[l.id]?.status==="rejected"&&m.value[l.id]?.notes?(r(),c("div",Mt,[a("p",Rt,[t[17]||(t[17]=a("strong",null,"Catatan:",-1)),d(" "+u(m.value[l.id].notes),1)])])):h("",!0),a("div",qt,[s(e(_),{size:"sm",variant:"outline",class:"flex-1 border-green-300 text-green-600 hover:bg-green-50",onClick:V=>Z(l.id),disabled:m.value[l.id]?.status==="approved"},{default:n(()=>[s(e(U),{class:"mr-1 size-4"}),t[18]||(t[18]=d(" Setuju ",-1))]),_:1},8,["onClick","disabled"]),s(e(_),{size:"sm",variant:"outline",class:"flex-1 border-red-300 text-red-600 hover:bg-red-50",onClick:V=>H(l.id)},{default:n(()=>[s(e(kt),{class:"mr-1 size-4"}),t[19]||(t[19]=d(" Tolak ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),i.student.student_biodata?.verifications?.length?h("",!0):(r(),y(e(S),{key:2},{default:n(()=>[s(e(T),{class:"py-12 text-center"},{default:n(()=>[s(e(M),{class:"mx-auto size-12 text-gray-300"}),t[20]||(t[20]=a("p",{class:"mt-4 text-gray-500"}," Belum ada dokumen yang perlu diverifikasi ",-1))]),_:1})]),_:1}))]),s(e(I),{open:w.value,"onUpdate:open":t[0]||(t[0]=l=>w.value=l)},{default:n(()=>[s(e(L),{class:"flex h-[85vh] max-w-4xl min-w-[80vw] flex-col"},{default:n(()=>[s(e(N),null,{default:n(()=>[s(e(A),null,{default:n(()=>[d(u($.value),1)]),_:1})]),_:1}),a("div",Ot,[D(b.value)?(r(),c("iframe",{key:0,src:b.value,class:"size-full",frameborder:"0"},null,8,Wt)):(r(),c("img",{key:1,src:b.value,alt:$.value,class:"size-full object-contain"},null,8,Ht))])]),_:1})]),_:1},8,["open"]),s(e(I),{open:v.value,"onUpdate:open":t[3]||(t[3]=l=>v.value=l)},{default:n(()=>[s(e(L),null,{default:n(()=>[s(e(N),null,{default:n(()=>[s(e(A),null,{default:n(()=>[...t[21]||(t[21]=[d("Tolak Dokumen",-1)])]),_:1}),s(e(st),null,{default:n(()=>[...t[22]||(t[22]=[d(" Berikan catatan untuk calon mahasiswa ",-1)])]),_:1})]),_:1}),a("div",Xt,[a("div",Zt,[s(e(lt),null,{default:n(()=>[...t[23]||(t[23]=[d("Catatan Penolakan *",-1)])]),_:1}),s(e(nt),{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l),rows:"3",placeholder:"Contoh: Foto tidak jelas, mohon upload ulang dengan resolusi lebih baik"},null,8,["modelValue"])])]),s(e(at),null,{default:n(()=>[s(e(_),{variant:"outline",onClick:t[2]||(t[2]=l=>v.value=!1)},{default:n(()=>[...t[24]||(t[24]=[d("Batal",-1)])]),_:1}),s(e(_),{variant:"destructive",onClick:X,disabled:!p.value},{default:n(()=>[...t[25]||(t[25]=[d(" Tolak ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ze as default};

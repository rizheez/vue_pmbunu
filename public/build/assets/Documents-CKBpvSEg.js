import{_ as V,a as B}from"./index-DEk99djT.js";import{_ as S}from"./AlertTitle.vue_vue_type_script_setup_true_lang-DO8JEUAp.js";import{_ as J}from"./index-D-jME6Ot.js";import{_ as f}from"./index-u_ueQ1j-.js";import{_ as T,a as Q,b as W,c as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-DCqfsORM.js";import{_ as I,a as N,b as L,c as P}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BX0-wLck.js";import{_ as Y}from"./DialogDescription.vue_vue_type_script_setup_true_lang-fOxdRM7C.js";import{_ as tt}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CUO2Cvgm.js";import{_ as et}from"./Label.vue_vue_type_script_setup_true_lang-kEpqXKDX.js";import{_ as st}from"./Textarea.vue_vue_type_script_setup_true_lang-CkcfNtky.js";import{_ as at}from"./AppLayout.vue_vue_type_script_setup_true_lang-KrPhG79J.js";import{d as lt,j as nt,c as A,p as c,a as _,e as a,u as e,h as ot,w as n,b as s,k,i as x,o as m,f as d,t as r,l as it,F as K,r as dt,n as rt,s as ut}from"./app-CcuLLWMw.js";import{C as E,F as mt}from"./file-text-BuDiMqOG.js";import{C as ct}from"./circle-alert-NcTBRFdR.js";import{A as pt}from"./arrow-left-DIW9aAIC.js";import{C as ft}from"./check-BbtBtz8f.js";import{c as _t}from"./createLucideIcon-DmmUP9a7.js";import{E as vt}from"./eye-DOycYUQK.js";import{C as gt}from"./circle-x-y3s0yQf6.js";import"./index-Do2AIBFg.js";import"./useForwardPropsEmits-BYM72Y4V.js";import"./x-CH2z8EwH.js";import"./useForwardExpose-CVoJtl4u.js";import"./VisuallyHidden-BIMyNfP6.js";import"./triangle-alert-TjeGXdBw.js";import"./index-BHw9BgFF.js";import"./index-CMWG4mbA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-plus-D9cn_rhc.js";const bt=_t("FileImageIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),kt={class:"flex flex-col gap-6 p-4"},xt={class:"flex items-center justify-between"},yt={class:"flex items-center gap-4"},ht={class:"text-sm text-gray-500"},Ct={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},$t={class:"flex items-center justify-between"},wt={key:0,class:"rounded-lg border bg-gray-50 p-4 text-sm"},jt={class:"grid gap-3"},zt={class:"font-medium"},Dt={class:"grid grid-cols-2 gap-2"},Vt={class:"font-medium font-mono"},Bt={class:"font-medium font-mono"},St={class:"grid grid-cols-2 gap-2"},Tt={class:"font-medium"},Ft={class:"font-medium"},It={class:"font-medium"},Nt=["onClick"],Lt=["src","alt"],Pt={class:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 transition hover:opacity-100"},At={key:2,class:"flex aspect-video items-center justify-center rounded-lg border bg-gray-50"},Kt={key:3,class:"rounded-md border border-red-200 bg-red-50 p-2"},Et={class:"text-xs text-red-600"},Ut={class:"flex gap-2"},Mt={class:"mt-4"},Rt=["src","alt"],qt={class:"space-y-4 py-4"},Ot={class:"space-y-2"},he=lt({__name:"Documents",props:{student:{}},setup(U){const o=U,M=nt(),g=A(()=>M.props.flash),y=c(!1),v=c(!1),h=c(!1),z=c(""),C=c(""),b=c(null),p=c(""),u=c({});(()=>{o.student.student_biodata?.verifications&&o.student.student_biodata.verifications.forEach(i=>{u.value[i.id]={status:i.status,notes:i.notes||""}})})();const R=[{title:"Admin Dashboard",href:"/admin/dashboard"},{title:"Calon Mahasiswa",href:"/admin/students"},{title:o.student.student_biodata?.name||o.student.name,href:`/admin/students/${o.student.id}`},{title:"Verifikasi Dokumen",href:"#"}],$={photo:"Pas Foto",ktp:"KTP",kk:"Kartu Keluarga",certificate:"Ijazah/SKL",biodata:"Biodata Diri"},w=i=>{const t=o.student.student_biodata;return t&&{photo:t.photo_url,ktp:t.ktp_url,kk:t.kk_url,certificate:t.certificate_url}[i]||null},j=i=>({pending:{variant:"outline",label:"Pending",class:"text-yellow-600 border-yellow-300"},approved:{variant:"default",label:"Disetujui",class:"bg-green-600"},rejected:{variant:"destructive",label:"Ditolak",class:""}})[i]||{variant:"secondary",label:"Unknown",class:""},q=(i,t)=>{z.value=i,C.value=t,h.value=!0},O=i=>{b.value=i,p.value=u.value[i]?.notes||"",v.value=!0},H=()=>{b.value&&(u.value[b.value]={status:"rejected",notes:p.value}),v.value=!1,b.value=null,p.value=""},X=i=>{u.value[i]={status:"approved",notes:""}},Z=()=>{const i=Object.entries(u.value).filter(t=>{const[,l]=t;return l.status!=="pending"}).map(([t,l])=>({id:parseInt(t),status:l.status,notes:l.notes}));if(i.length===0){alert("Pilih status verifikasi untuk minimal 1 dokumen");return}y.value=!0,ut.post(`/admin/students/${o.student.id}/documents/bulk-verify`,{verifications:i},{onFinish:()=>{y.value=!1}})},G=A(()=>Object.values(u.value).some(i=>i.status!=="pending"));return(i,t)=>(m(),_(K,null,[a(e(ot),{title:`Verifikasi Dokumen - ${o.student.name}`},null,8,["title"]),a(at,{breadcrumbs:R},{default:n(()=>[s("div",kt,[g.value?.success?(m(),k(e(V),{key:0,class:"border-green-500 bg-green-50"},{default:n(()=>[a(e(E),{class:"size-4 text-green-600"}),a(e(S),{class:"text-green-800"},{default:n(()=>[...t[4]||(t[4]=[d("Berhasil",-1)])]),_:1}),a(e(B),{class:"text-green-700"},{default:n(()=>[d(r(g.value.success),1)]),_:1})]),_:1})):x("",!0),g.value?.error?(m(),k(e(V),{key:1,variant:"destructive"},{default:n(()=>[a(e(ct),{class:"size-4"}),a(e(S),null,{default:n(()=>[...t[5]||(t[5]=[d("Error",-1)])]),_:1}),a(e(B),null,{default:n(()=>[d(r(g.value.error),1)]),_:1})]),_:1})):x("",!0),s("div",xt,[s("div",yt,[a(e(f),{variant:"ghost",size:"sm","as-child":""},{default:n(()=>[a(e(it),{href:`/admin/students/${o.student.id}`},{default:n(()=>[a(e(pt),{class:"mr-2 size-4"}),t[6]||(t[6]=d(" Kembali ",-1))]),_:1},8,["href"])]),_:1}),s("div",null,[t[7]||(t[7]=s("h1",{class:"text-2xl font-bold"},"Verifikasi Dokumen",-1)),s("p",ht,r(o.student.student_biodata?.name||o.student.name),1)])]),a(e(f),{onClick:Z,disabled:!G.value||y.value,class:"bg-teal-600 hover:bg-teal-700"},{default:n(()=>[a(e(ft),{class:"mr-2 size-4"}),t[8]||(t[8]=d(" Simpan Verifikasi ",-1))]),_:1},8,["disabled"])]),s("div",Ct,[(m(!0),_(K,null,dt(o.student.student_biodata?.verifications,l=>(m(),k(e(T),{key:l.id},{default:n(()=>[a(e(Q),{class:"pb-3"},{default:n(()=>[s("div",$t,[a(e(W),{class:"flex items-center gap-2 text-base"},{default:n(()=>[a(e(bt),{class:"size-4"}),d(" "+r($[l.document_type]||l.document_type),1)]),_:2},1024),a(e(J),{variant:j(u.value[l.id]?.status||l.status).variant,class:rt(j(u.value[l.id]?.status||l.status).class)},{default:n(()=>[d(r(j(u.value[l.id]?.status||l.status).label),1)]),_:2},1032,["variant","class"])])]),_:2},1024),a(e(F),{class:"space-y-4"},{default:n(()=>[l.document_type==="biodata"?(m(),_("div",wt,[s("div",jt,[s("div",null,[t[9]||(t[9]=s("span",{class:"text-xs text-gray-500"},"Nama Lengkap",-1)),s("p",zt,r(o.student.student_biodata?.name),1)]),s("div",Dt,[s("div",null,[t[10]||(t[10]=s("span",{class:"text-xs text-gray-500"},"NIK",-1)),s("p",Vt,r(o.student.student_biodata?.nik),1)]),s("div",null,[t[11]||(t[11]=s("span",{class:"text-xs text-gray-500"},"NISN",-1)),s("p",Bt,r(o.student.student_biodata?.nisn||"-"),1)])]),s("div",St,[s("div",null,[t[12]||(t[12]=s("span",{class:"text-xs text-gray-500"},"Tempat, Tgl Lahir",-1)),s("p",Tt,r(o.student.student_biodata?.birth_place)+", "+r(o.student.student_biodata?.birth_date),1)]),s("div",null,[t[13]||(t[13]=s("span",{class:"text-xs text-gray-500"},"Agama",-1)),s("p",Ft,r(o.student.student_biodata?.religion),1)])]),s("div",null,[t[14]||(t[14]=s("span",{class:"text-xs text-gray-500"},"Asal Sekolah",-1)),s("p",It,r(o.student.student_biodata?.school_origin),1)])])])):w(l.document_type)?(m(),_("div",{key:1,class:"relative aspect-video cursor-pointer overflow-hidden rounded-lg border bg-gray-100",onClick:D=>q(w(l.document_type),$[l.document_type])},[s("img",{src:w(l.document_type),alt:$[l.document_type],class:"size-full object-cover transition hover:scale-105"},null,8,Lt),s("div",Pt,[a(e(vt),{class:"size-8 text-white"})])],8,Nt)):(m(),_("div",At,[...t[15]||(t[15]=[s("p",{class:"text-sm text-gray-400"},"Tidak ada file",-1)])])),u.value[l.id]?.status==="rejected"&&u.value[l.id]?.notes?(m(),_("div",Kt,[s("p",Et,[t[16]||(t[16]=s("strong",null,"Catatan:",-1)),d(" "+r(u.value[l.id].notes),1)])])):x("",!0),s("div",Ut,[a(e(f),{size:"sm",variant:"outline",class:"flex-1 border-green-300 text-green-600 hover:bg-green-50",onClick:D=>X(l.id),disabled:u.value[l.id]?.status==="approved"},{default:n(()=>[a(e(E),{class:"mr-1 size-4"}),t[17]||(t[17]=d(" Setuju ",-1))]),_:1},8,["onClick","disabled"]),a(e(f),{size:"sm",variant:"outline",class:"flex-1 border-red-300 text-red-600 hover:bg-red-50",onClick:D=>O(l.id)},{default:n(()=>[a(e(gt),{class:"mr-1 size-4"}),t[18]||(t[18]=d(" Tolak ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),o.student.student_biodata?.verifications?.length?x("",!0):(m(),k(e(T),{key:2},{default:n(()=>[a(e(F),{class:"py-12 text-center"},{default:n(()=>[a(e(mt),{class:"mx-auto size-12 text-gray-300"}),t[19]||(t[19]=s("p",{class:"mt-4 text-gray-500"},"Belum ada dokumen yang perlu diverifikasi",-1))]),_:1})]),_:1}))]),a(e(I),{open:h.value,"onUpdate:open":t[0]||(t[0]=l=>h.value=l)},{default:n(()=>[a(e(N),{class:"max-w-3xl"},{default:n(()=>[a(e(L),null,{default:n(()=>[a(e(P),null,{default:n(()=>[d(r(C.value),1)]),_:1})]),_:1}),s("div",Mt,[s("img",{src:z.value,alt:C.value,class:"w-full rounded-lg"},null,8,Rt)])]),_:1})]),_:1},8,["open"]),a(e(I),{open:v.value,"onUpdate:open":t[3]||(t[3]=l=>v.value=l)},{default:n(()=>[a(e(N),null,{default:n(()=>[a(e(L),null,{default:n(()=>[a(e(P),null,{default:n(()=>[...t[20]||(t[20]=[d("Tolak Dokumen",-1)])]),_:1}),a(e(Y),null,{default:n(()=>[...t[21]||(t[21]=[d(" Berikan catatan untuk calon mahasiswa ",-1)])]),_:1})]),_:1}),s("div",qt,[s("div",Ot,[a(e(et),null,{default:n(()=>[...t[22]||(t[22]=[d("Catatan Penolakan *",-1)])]),_:1}),a(e(st),{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l),rows:"3",placeholder:"Contoh: Foto tidak jelas, mohon upload ulang dengan resolusi lebih baik"},null,8,["modelValue"])])]),a(e(tt),null,{default:n(()=>[a(e(f),{variant:"outline",onClick:t[2]||(t[2]=l=>v.value=!1)},{default:n(()=>[...t[23]||(t[23]=[d("Batal",-1)])]),_:1}),a(e(f),{variant:"destructive",onClick:H,disabled:!p.value},{default:n(()=>[...t[24]||(t[24]=[d(" Tolak ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{he as default};

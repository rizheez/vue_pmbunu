import{d as X,p as m,A as J,a as p,e as a,u as s,h as Q,w as o,b as e,t as i,k as M,i as v,f as c,o as d,q as $,B as Y,C as L,F as z,r as P,n as Z,l as ee,s as j}from"./app-D5OcARYv.js";import{M as D,a as C,_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-DinLlKE5.js";import{_ as b}from"./index-UEfTj4wh.js";import{_ as f,c as _,a as se,b as ae}from"./CardTitle.vue_vue_type_script_setup_true_lang-C3mlPz-I.js";import{_ as le}from"./CardDescription.vue_vue_type_script_setup_true_lang-Df8MYE_q.js";import{_ as oe,a as ie,b as ne,c as de}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BQo5Yl-l.js";import{_ as re}from"./DialogDescription.vue_vue_type_script_setup_true_lang-silKCfmM.js";import{_ as T}from"./Input.vue_vue_type_script_setup_true_lang-CCcVPA01.js";import{c as ue}from"./createLucideIcon-x21i96bS.js";import{G as R}from"./globe-CXldDmEr.js";import{C as G}from"./circle-x-D2BRpvpn.js";import{C as pe}from"./clock-DberM45p.js";import{T as B}from"./ChatWidget.vue_vue_type_script_setup_true_lang-lf1i5k0i.js";import{S as ce}from"./search-8GcQTARh.js";import{E as me}from"./eye-BZqzdpIM.js";import"./VisuallyHidden-uWdxpz0q.js";import"./index-Bo1-g3F-.js";import"./triangle-alert-BmIPATx-.js";import"./file-text-CV_xxGPM.js";import"./useForwardExpose-CO2v1_2r.js";import"./useForwardPropsEmits-Dl70jCDi.js";import"./index-CMWG4mbA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-plus-LeFNbwb6.js";import"./loader-circle-DhjY_-Pi.js";const H=ue("DatabaseIcon",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),fe={class:"flex flex-col gap-6 p-4"},_e={class:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-6"},xe={class:"flex items-center gap-3"},ve={class:"flex size-10 items-center justify-center rounded-lg bg-blue-100"},ge={class:"text-2xl font-bold"},ye={class:"flex items-center gap-3"},he={class:"flex size-10 items-center justify-center rounded-lg bg-green-100"},be={class:"text-2xl font-bold"},ke={class:"flex items-center gap-3"},we={class:"flex size-10 items-center justify-center rounded-lg bg-purple-100"},ze={class:"text-2xl font-bold"},De={class:"flex items-center gap-3"},Ce={class:"flex size-10 items-center justify-center rounded-lg bg-blue-100"},Ae={class:"text-2xl font-bold"},Ie={class:"flex items-center gap-3"},Se={class:"flex size-10 items-center justify-center rounded-lg bg-red-100"},Ve={class:"text-2xl font-bold"},$e={class:"flex items-center gap-3"},Le={class:"flex size-10 items-center justify-center rounded-lg bg-yellow-100"},je={class:"text-2xl font-bold"},Te={class:"flex items-center justify-between"},Ue={class:"mb-6 flex flex-wrap gap-4"},Me={class:"flex items-center gap-2"},Pe={class:"overflow-x-auto rounded-lg border"},Re={class:"w-full text-sm"},Ge={class:"divide-y"},Be={class:"px-4 py-3 text-xs whitespace-nowrap text-gray-500"},He={class:"px-4 py-3"},Ee={key:0,class:"flex flex-col"},Fe={class:"font-medium"},Ne={class:"text-xs text-gray-500"},qe={key:1,class:"text-gray-400"},Ke={class:"px-4 py-3"},We={class:"px-4 py-3"},Oe=["title"],Xe={class:"px-4 py-3"},Je=["title"],Qe={class:"px-4 py-3"},Ye={class:"px-4 py-3 text-center"},Ze={key:0,class:"font-mono text-xs"},et={key:1,class:"text-gray-400"},tt={class:"px-4 py-3"},st={class:"px-4 py-3"},at={class:"flex gap-1"},lt={key:0},ot={key:0,class:"mt-4 flex items-center justify-between"},it={class:"text-sm text-gray-500"},nt={class:"flex gap-1"},dt=["innerHTML"],rt={key:0,class:"space-y-6"},ut={class:"grid grid-cols-2 gap-4"},pt={class:"space-y-1"},ct={class:"text-sm"},mt={class:"space-y-1"},ft={key:0,class:"text-sm"},_t={key:1,class:"text-sm text-gray-400"},xt={class:"space-y-1"},vt={class:"font-mono text-sm"},gt={class:"space-y-1"},yt={class:"font-mono text-xs break-all"},ht={class:"space-y-1"},bt={class:"space-y-1"},kt={class:"font-mono text-sm"},wt={class:"space-y-1"},zt={class:"space-y-2"},Dt={class:"rounded-lg border bg-blue-50 p-4 dark:bg-blue-950"},Ct={class:"text-sm whitespace-pre-wrap"},At={class:"space-y-2"},It={class:"rounded-lg border bg-gray-50 p-4 dark:bg-gray-900"},St={class:"text-sm whitespace-pre-wrap"},Vt={key:0,class:"space-y-2"},$t={class:"rounded-lg border border-red-200 bg-red-50 p-4 dark:bg-red-950"},Lt={class:"text-sm whitespace-pre-wrap text-red-700"},ls=X({__name:"Index",props:{logs:{},filters:{},stats:{}},setup(r){const x=r,A=m(x.filters.search||""),g=m(x.filters.provider||"all"),y=m(x.filters.status||"all"),I=m(x.filters.date_from||""),S=m(x.filters.date_to||""),k=m(x.filters.per_page||15),V=m(!1),n=m(null),E=u=>{n.value=u,V.value=!0},h=()=>{j.get("/admin/chat-logs",{search:A.value||void 0,provider:g.value!=="all"?g.value:void 0,status:y.value!=="all"?y.value:void 0,date_from:I.value||void 0,date_to:S.value||void 0,per_page:k.value},{preserveState:!0})};J([g,y,k],()=>h());const w=u=>({database:{variant:"secondary",label:"Database",icon:H},openrouter:{variant:"default",label:"API",icon:R},rejection:{variant:"destructive",label:"Rejected",icon:G}})[u]||{variant:"outline",label:u,icon:D},F=u=>new Date(u).toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=u=>new Date(u).toLocaleString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),U=(u,t=100)=>u.length>t?u.slice(0,t)+"...":u,q=u=>{confirm("Apakah Anda yakin ingin menghapus log ini?")&&j.delete(`/admin/chat-logs/${u}`)},K=()=>{confirm("Apakah Anda yakin ingin menghapus SEMUA log? Tindakan ini tidak dapat dibatalkan!")&&j.delete("/admin/chat-logs")},W=[{title:"Admin Dashboard",href:"/admin/dashboard"},{title:"Log Chat AI",href:"/admin/chat-logs"}];return(u,t)=>(d(),p(z,null,[a(s(Q),{title:"Log Chat AI"}),a(te,{breadcrumbs:W},{default:o(()=>[e("div",fe,[e("div",_e,[a(s(f),null,{default:o(()=>[a(s(_),{class:"p-4"},{default:o(()=>[e("div",xe,[e("div",ve,[a(s(D),{class:"size-5 text-blue-600"})]),e("div",null,[e("p",ge,i(r.stats.total),1),t[7]||(t[7]=e("p",{class:"text-xs text-muted-foreground"}," Total Log ",-1))])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(_),{class:"p-4"},{default:o(()=>[e("div",ye,[e("div",he,[a(s(D),{class:"size-5 text-green-600"})]),e("div",null,[e("p",be,i(r.stats.today),1),t[8]||(t[8]=e("p",{class:"text-xs text-muted-foreground"}," Hari Ini ",-1))])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(_),{class:"p-4"},{default:o(()=>[e("div",ke,[e("div",we,[a(s(H),{class:"size-5 text-purple-600"})]),e("div",null,[e("p",ze,i(r.stats.database_responses),1),t[9]||(t[9]=e("p",{class:"text-xs text-muted-foreground"}," Dari Database ",-1))])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(_),{class:"p-4"},{default:o(()=>[e("div",De,[e("div",Ce,[a(s(R),{class:"size-5 text-blue-600"})]),e("div",null,[e("p",Ae,i(r.stats.api_responses),1),t[10]||(t[10]=e("p",{class:"text-xs text-muted-foreground"}," Dari API ",-1))])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(_),{class:"p-4"},{default:o(()=>[e("div",Ie,[e("div",Se,[a(s(G),{class:"size-5 text-red-600"})]),e("div",null,[e("p",Ve,i(r.stats.failed),1),t[11]||(t[11]=e("p",{class:"text-xs text-muted-foreground"}," Gagal ",-1))])])]),_:1})]),_:1}),a(s(f),null,{default:o(()=>[a(s(_),{class:"p-4"},{default:o(()=>[e("div",$e,[e("div",Le,[a(s(pe),{class:"size-5 text-yellow-600"})]),e("div",null,[e("p",je,i(r.stats.avg_response_time)+"ms ",1),t[12]||(t[12]=e("p",{class:"text-xs text-muted-foreground"}," Avg Response ",-1))])])]),_:1})]),_:1})]),a(s(f),null,{default:o(()=>[a(s(se),null,{default:o(()=>[e("div",Te,[e("div",null,[a(s(ae),null,{default:o(()=>[...t[13]||(t[13]=[c("Log Chat AI",-1)])]),_:1}),a(s(le),null,{default:o(()=>[...t[14]||(t[14]=[c(" Riwayat percakapan dengan chatbot AI ",-1)])]),_:1})]),r.stats.total>0?(d(),M(s(b),{key:0,variant:"destructive",size:"sm",class:"gap-2",onClick:K},{default:o(()=>[a(s(B),{class:"size-4"}),t[15]||(t[15]=c(" Hapus Semua ",-1))]),_:1})):v("",!0)])]),_:1}),a(s(_),null,{default:o(()=>[e("div",Ue,[e("div",Me,[a(s(T),{modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=l=>A.value=l),placeholder:"Cari pesan...",class:"w-64",onKeyup:Y(h,["enter"])},null,8,["modelValue"]),a(s(b),{size:"icon",variant:"outline",onClick:h},{default:o(()=>[a(s(ce),{class:"size-4"})]),_:1})]),$(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>g.value=l),class:"rounded-md border border-input bg-transparent px-3 py-2 text-sm"},[...t[16]||(t[16]=[e("option",{value:"all"},"Semua Provider",-1),e("option",{value:"database"},"Database",-1),e("option",{value:"openrouter"},"API (OpenRouter)",-1),e("option",{value:"rejection"},"Rejection",-1)])],512),[[L,g.value]]),$(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),class:"rounded-md border border-input bg-transparent px-3 py-2 text-sm"},[...t[17]||(t[17]=[e("option",{value:"all"},"Semua Status",-1),e("option",{value:"success"},"Sukses",-1),e("option",{value:"failed"},"Gagal",-1)])],512),[[L,y.value]]),a(s(T),{modelValue:I.value,"onUpdate:modelValue":t[3]||(t[3]=l=>I.value=l),type:"date",class:"w-40",placeholder:"Dari tanggal",onChange:h},null,8,["modelValue"]),a(s(T),{modelValue:S.value,"onUpdate:modelValue":t[4]||(t[4]=l=>S.value=l),type:"date",class:"w-40",placeholder:"Sampai tanggal",onChange:h},null,8,["modelValue"]),$(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>k.value=l),class:"rounded-md border border-input bg-transparent px-3 py-2 text-sm"},[...t[18]||(t[18]=[e("option",{value:15},"15 per halaman",-1),e("option",{value:25},"25 per halaman",-1),e("option",{value:50},"50 per halaman",-1),e("option",{value:100},"100 per halaman",-1),e("option",{value:200},"200 per halaman",-1),e("option",{value:500},"500 per halaman",-1),e("option",{value:1e3},"1000 per halaman",-1)])],512),[[L,k.value]])]),e("div",Pe,[e("table",Re,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left font-medium"}," Waktu "),e("th",{class:"px-4 py-3 text-left font-medium"}," User "),e("th",{class:"px-4 py-3 text-left font-medium"}," IP "),e("th",{class:"min-w-[250px] px-4 py-3 text-left font-medium"}," Input "),e("th",{class:"min-w-[300px] px-4 py-3 text-left font-medium"}," Response "),e("th",{class:"px-4 py-3 text-left font-medium"}," Provider "),e("th",{class:"px-4 py-3 text-left font-medium"}," Response Time "),e("th",{class:"px-4 py-3 text-left font-medium"}," Status "),e("th",{class:"px-4 py-3 text-left font-medium"}," Aksi ")])],-1)),e("tbody",Ge,[(d(!0),p(z,null,P(r.logs.data,l=>(d(),p("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",Be,i(F(l.created_at)),1),e("td",He,[l.user?(d(),p("div",Ee,[e("span",Fe,i(l.user.name),1),e("span",Ne,i(l.user.email),1)])):(d(),p("span",qe,"Guest"))]),e("td",Ke,i(l.ip_address),1),e("td",We,[e("p",{class:"text-sm whitespace-pre-wrap",title:l.user_input},i(U(l.user_input,150)),9,Oe)]),e("td",Xe,[e("p",{class:"text-sm whitespace-pre-wrap text-gray-600",title:l.ai_response},i(U(l.ai_response,200)),9,Je)]),e("td",Qe,[a(s(C),{variant:w(l.provider).variant},{default:o(()=>[c(i(w(l.provider).label),1)]),_:2},1032,["variant"])]),e("td",Ye,[l.response_time_ms?(d(),p("span",Ze,i(l.response_time_ms)+"ms ",1)):(d(),p("span",et,"-"))]),e("td",tt,[a(s(C),{variant:l.is_successful?"default":"destructive"},{default:o(()=>[c(i(l.is_successful?"Sukses":"Gagal"),1)]),_:2},1032,["variant"])]),e("td",st,[e("div",at,[a(s(b),{variant:"ghost",size:"icon",class:"text-blue-500 hover:bg-blue-50 hover:text-blue-700",onClick:O=>E(l),title:"Lihat Detail"},{default:o(()=>[a(s(me),{class:"size-4"})]),_:1},8,["onClick"]),a(s(b),{variant:"ghost",size:"icon",class:"text-red-500 hover:bg-red-50 hover:text-red-700",onClick:O=>q(l.id),title:"Hapus"},{default:o(()=>[a(s(B),{class:"size-4"})]),_:1},8,["onClick"])])])]))),128)),r.logs.data.length===0?(d(),p("tr",lt,[...t[19]||(t[19]=[e("td",{colspan:"9",class:"px-4 py-8 text-center text-gray-500"}," Tidak ada log chat ",-1)])])):v("",!0)])])]),r.logs.last_page>1?(d(),p("div",ot,[e("p",it," Halaman "+i(r.logs.current_page)+" dari "+i(r.logs.last_page)+" ("+i(r.logs.total)+" log) ",1),e("div",nt,[(d(!0),p(z,null,P(r.logs.links,l=>(d(),p(z,{key:l.label},[l.url?(d(),M(s(b),{key:0,"as-child":"",variant:"outline",size:"sm",class:Z({"bg-primary text-primary-foreground":l.active})},{default:o(()=>[a(s(ee),{href:l.url},{default:o(()=>[e("span",{innerHTML:l.label},null,8,dt)]),_:2},1032,["href"])]),_:2},1032,["class"])):v("",!0)],64))),128))])])):v("",!0)]),_:1})]),_:1})]),a(s(oe),{open:V.value,"onUpdate:open":t[6]||(t[6]=l=>V.value=l)},{default:o(()=>[a(s(ie),{class:"max-h-[90vh] max-w-3xl overflow-y-auto"},{default:o(()=>[a(s(ne),null,{default:o(()=>[a(s(de),{class:"flex items-center gap-2"},{default:o(()=>[a(s(D),{class:"size-5"}),t[21]||(t[21]=c(" Detail Log Chat ",-1))]),_:1}),a(s(re),null,{default:o(()=>[c(" Log ID: #"+i(n.value?.id),1)]),_:1})]),_:1}),n.value?(d(),p("div",rt,[e("div",ut,[e("div",pt,[t[22]||(t[22]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Waktu ",-1)),e("p",ct,i(N(n.value.created_at)),1)]),e("div",mt,[t[23]||(t[23]=e("p",{class:"text-sm font-medium text-muted-foreground"}," User ",-1)),n.value.user?(d(),p("p",ft,i(n.value.user.name)+" ("+i(n.value.user.email)+") ",1)):(d(),p("p",_t,"Guest"))]),e("div",xt,[t[24]||(t[24]=e("p",{class:"text-sm font-medium text-muted-foreground"}," IP Address ",-1)),e("p",vt,i(n.value.ip_address||"-"),1)]),e("div",gt,[t[25]||(t[25]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Session ID ",-1)),e("p",yt,i(n.value.session_id||"-"),1)]),e("div",ht,[t[26]||(t[26]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Provider ",-1)),a(s(C),{variant:w(n.value.provider).variant},{default:o(()=>[c(i(w(n.value.provider).label),1)]),_:1},8,["variant"])]),e("div",bt,[t[27]||(t[27]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Response Time ",-1)),e("p",kt,i(n.value.response_time_ms?`${n.value.response_time_ms}ms`:"-"),1)]),e("div",wt,[t[28]||(t[28]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Status ",-1)),a(s(C),{variant:n.value.is_successful?"default":"destructive"},{default:o(()=>[c(i(n.value.is_successful?"Sukses":"Gagal"),1)]),_:1},8,["variant"])])]),e("div",zt,[t[29]||(t[29]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Input User ",-1)),e("div",Dt,[e("p",Ct,i(n.value.user_input),1)])]),e("div",At,[t[30]||(t[30]=e("p",{class:"text-sm font-medium text-muted-foreground"}," Response AI ",-1)),e("div",It,[e("p",St,i(n.value.ai_response),1)])]),n.value.error_message?(d(),p("div",Vt,[t[31]||(t[31]=e("p",{class:"text-sm font-medium text-red-600"}," Error Message ",-1)),e("div",$t,[e("p",Lt,i(n.value.error_message),1)])])):v("",!0)])):v("",!0)]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ls as default};

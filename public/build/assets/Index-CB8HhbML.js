import{d as W,p as v,x as H,C as q,s as C,a as d,e as a,u as e,h as J,w as l,b as n,f as i,i as k,o,F as h,r as D,t as u,n as K,k as Q,y as X,q as G,z as O}from"./app-BVGEWM6K.js";import{_ as p}from"./index-CuVZe7j4.js";import{_ as Y,a as Z,b as ee,c as te}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bb0dQkAi.js";import{_ as ae}from"./CardDescription.vue_vue_type_script_setup_true_lang-ybtA_fUi.js";import{_ as P,a as V,b as S,c as T}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BSr2jyqi.js";import{_ as z}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BbwUAZGB.js";import{_ as B}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BIGcW6rl.js";import{_ as se}from"./Input.vue_vue_type_script_setup_true_lang-DFHgkly1.js";import{_ as le}from"./Label.vue_vue_type_script_setup_true_lang-BvsyPPpw.js";import{_ as ne,a as re,b as ie,c as oe,d as w}from"./SelectValue.vue_vue_type_script_setup_true_lang-AHP0eiAd.js";import{_ as de}from"./AppLayout.vue_vue_type_script_setup_true_lang-_9AFCHFl.js";import{S as ue}from"./search-BJhDGSpg.js";import{E as me}from"./eye-Czoc8dbX.js";import{C as fe}from"./check-Ud3FOmGM.js";import{X as pe}from"./ChatWidget.vue_vue_type_script_setup_true_lang-8vk_Rcrv.js";import"./useForwardPropsEmits-BY2ZqorI.js";import"./index-vOq7kyG5.js";import"./useForwardExpose-lJv4PZJE.js";import"./VisuallyHidden-CgUpF-d-.js";import"./createLucideIcon-C5lEgyj2.js";import"./chevron-down-CF4ygwe1.js";import"./useFormControl-DqSJMijB.js";import"./triangle-alert-CxWneAaW.js";import"./circle-x-DmwNEScS.js";import"./file-text-O6G_wzb4.js";import"./index-CMWG4mbA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-plus-BfKVh4__.js";import"./loader-circle-7M2jXDkv.js";const ce={class:"flex flex-col gap-6 p-4"},_e={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center"},ve={class:"relative flex-1"},ge={class:"overflow-x-auto rounded-lg border"},xe={class:"w-full text-sm"},ye={class:"divide-y"},be={class:"px-4 py-3"},ke={class:"font-medium"},he={class:"text-xs text-muted-foreground"},we={class:"px-4 py-3 font-medium"},$e={class:"px-4 py-3 text-muted-foreground"},Ce={class:"px-4 py-3"},je={class:"px-4 py-3"},De={class:"flex items-center justify-center gap-2"},Pe={key:0},Ve={key:0,class:"mt-4 flex items-center justify-between"},Se={class:"text-sm text-muted-foreground"},Te={class:"flex gap-2"},ze={class:"flex justify-center p-4"},Be=["src"],Ue=["src"],Fe={class:"space-y-2"},Me={key:0,class:"text-sm text-red-500"},ft=W({__name:"Index",props:{payments:{},filters:{}},setup(f){const j=f,U=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Verifikasi Pembayaran",href:"/admin/reregistration-payments"}],y=v(j.filters.search),g=v(j.filters.status),b=v(!1),x=v(!1),c=v(null),_=v(""),m=H({notes:""});q([y,g],()=>{C.get("/admin/reregistration-payments",{search:y.value||void 0,status:g.value!=="all"?g.value:void 0},{preserveState:!0,replace:!0})});const F=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r),M=r=>new Date(r).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),I=r=>{r.payment_proof_path&&(_.value=`/storage/${r.payment_proof_path}`,c.value=r,b.value=!0)},L=r=>{confirm("Apakah Anda yakin ingin memverifikasi pembayaran ini?")&&C.post(`/admin/reregistration-payments/${r.id}/verify`,{})},N=r=>{c.value=r,m.reset(),x.value=!0},A=()=>{c.value&&m.post(`/admin/reregistration-payments/${c.value.id}/reject`,{onSuccess:()=>{x.value=!1,m.reset()}})},R=r=>{switch(r){case"verified":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"}},E=r=>{switch(r){case"verified":return"Terverifikasi";case"rejected":return"Ditolak";default:return"Pending"}};return(r,t)=>(o(),d(h,null,[a(e(J),{title:"Verifikasi Pembayaran Daftar Ulang"}),a(de,{breadcrumbs:U},{default:l(()=>[n("div",ce,[a(e(Y),null,{default:l(()=>[a(e(Z),null,{default:l(()=>[a(e(ee),null,{default:l(()=>[...t[7]||(t[7]=[i("Verifikasi Pembayaran Daftar Ulang",-1)])]),_:1}),a(e(ae),null,{default:l(()=>[...t[8]||(t[8]=[i(" Kelola dan verifikasi pembayaran daftar ulang mahasiswa ",-1)])]),_:1})]),_:1}),a(e(te),null,{default:l(()=>[n("div",_e,[n("div",ve,[a(e(ue),{class:"absolute top-1/2 left-3 size-4 -translate-y-1/2 text-muted-foreground"}),a(e(se),{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),placeholder:"Cari nama atau email...",class:"pl-10"},null,8,["modelValue"])]),a(e(ne),{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s)},{default:l(()=>[a(e(re),{class:"w-full sm:w-48"},{default:l(()=>[a(e(ie),{placeholder:"Filter Status"})]),_:1}),a(e(oe),null,{default:l(()=>[a(e(w),{value:"all"},{default:l(()=>[...t[9]||(t[9]=[i("Semua",-1)])]),_:1}),a(e(w),{value:"pending"},{default:l(()=>[...t[10]||(t[10]=[i("Pending",-1)])]),_:1}),a(e(w),{value:"verified"},{default:l(()=>[...t[11]||(t[11]=[i("Terverifikasi",-1)])]),_:1}),a(e(w),{value:"rejected"},{default:l(()=>[...t[12]||(t[12]=[i("Ditolak",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",ge,[n("table",xe,[t[14]||(t[14]=n("thead",{class:"bg-muted/50"},[n("tr",null,[n("th",{class:"px-4 py-3 text-left font-medium"}," Mahasiswa "),n("th",{class:"px-4 py-3 text-left font-medium"}," Jumlah "),n("th",{class:"px-4 py-3 text-left font-medium"}," Tanggal Upload "),n("th",{class:"px-4 py-3 text-left font-medium"}," Status "),n("th",{class:"px-4 py-3 text-center font-medium"}," Aksi ")])],-1)),n("tbody",ye,[(o(!0),d(h,null,D(f.payments.data,s=>(o(),d("tr",{key:s.id,class:"hover:bg-muted/50"},[n("td",be,[n("div",null,[n("div",ke,u(s.user.student_biodata?.name||s.user.name),1),n("div",he,u(s.user.email),1)])]),n("td",we,u(F(s.amount)),1),n("td",$e,u(M(s.created_at)),1),n("td",Ce,[n("span",{class:K(["rounded-full px-2 py-1 text-xs font-medium",R(s.status)])},u(E(s.status)),3)]),n("td",je,[n("div",De,[a(e(p),{size:"sm",variant:"outline",onClick:$=>I(s),disabled:!s.payment_proof_path},{default:l(()=>[a(e(me),{class:"size-4"})]),_:1},8,["onClick","disabled"]),s.status==="pending"?(o(),d(h,{key:0},[a(e(p),{size:"sm",variant:"default",class:"bg-green-600 hover:bg-green-700",onClick:$=>L(s)},{default:l(()=>[a(e(fe),{class:"size-4"})]),_:1},8,["onClick"]),a(e(p),{size:"sm",variant:"destructive",onClick:$=>N(s)},{default:l(()=>[a(e(pe),{class:"size-4"})]),_:1},8,["onClick"])],64)):k("",!0)])])]))),128)),f.payments.data.length===0?(o(),d("tr",Pe,[...t[13]||(t[13]=[n("td",{colspan:"5",class:"px-4 py-8 text-center text-muted-foreground"}," Tidak ada data pembayaran ",-1)])])):k("",!0)])])]),f.payments.last_page>1?(o(),d("div",Ve,[n("p",Se," Menampilkan "+u(f.payments.data.length)+" dari "+u(f.payments.total)+" data ",1),n("div",Te,[(o(!0),d(h,null,D(f.payments.links,s=>(o(),Q(e(p),{key:s.label,size:"sm",variant:s.active?"default":"outline",disabled:!s.url,onClick:$=>s.url&&e(C).get(s.url),innerHTML:s.label},null,8,["variant","disabled","onClick","innerHTML"]))),128))])])):k("",!0)]),_:1})]),_:1})]),a(e(P),{open:b.value,"onUpdate:open":t[3]||(t[3]=s=>b.value=s)},{default:l(()=>[a(e(V),{class:"max-w-3xl"},{default:l(()=>[a(e(S),null,{default:l(()=>[a(e(T),null,{default:l(()=>[...t[15]||(t[15]=[i("Bukti Pembayaran",-1)])]),_:1}),a(e(z),null,{default:l(()=>[i(u(c.value?.user.student_biodata?.name||c.value?.user.name),1)]),_:1})]),_:1}),n("div",ze,[_.value.endsWith(".jpg")||_.value.endsWith(".jpeg")||_.value.endsWith(".png")?(o(),d("img",{key:0,src:_.value,alt:"Bukti Pembayaran",class:"max-h-[60vh] rounded-lg object-contain"},null,8,Be)):(o(),d("iframe",{key:1,src:_.value,class:"h-[60vh] w-full rounded-lg"},null,8,Ue))]),a(e(B),null,{default:l(()=>[a(e(p),{variant:"outline",onClick:t[2]||(t[2]=s=>b.value=!1)},{default:l(()=>[...t[16]||(t[16]=[i(" Tutup ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(e(P),{open:x.value,"onUpdate:open":t[6]||(t[6]=s=>x.value=s)},{default:l(()=>[a(e(V),null,{default:l(()=>[a(e(S),null,{default:l(()=>[a(e(T),null,{default:l(()=>[...t[17]||(t[17]=[i("Tolak Pembayaran",-1)])]),_:1}),a(e(z),null,{default:l(()=>[...t[18]||(t[18]=[i(" Berikan alasan penolakan untuk mahasiswa ",-1)])]),_:1})]),_:1}),n("form",{onSubmit:X(A,["prevent"]),class:"space-y-4"},[n("div",Fe,[a(e(le),{for:"reject_notes"},{default:l(()=>[...t[19]||(t[19]=[i("Alasan Penolakan *",-1)])]),_:1}),G(n("textarea",{id:"reject_notes","onUpdate:modelValue":t[4]||(t[4]=s=>e(m).notes=s),rows:"3",class:"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs placeholder:text-muted-foreground focus-visible:ring-1 focus-visible:ring-ring focus-visible:outline-none",placeholder:"Contoh: Bukti pembayaran tidak jelas, nominal tidak sesuai, dll."},null,512),[[O,e(m).notes]]),e(m).errors.notes?(o(),d("p",Me,u(e(m).errors.notes),1)):k("",!0)]),a(e(B),null,{default:l(()=>[a(e(p),{type:"button",variant:"outline",onClick:t[5]||(t[5]=s=>x.value=!1)},{default:l(()=>[...t[20]||(t[20]=[i(" Batal ",-1)])]),_:1}),a(e(p),{type:"submit",variant:"destructive",disabled:e(m).processing},{default:l(()=>[...t[21]||(t[21]=[i(" Tolak Pembayaran ",-1)])]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ft as default};

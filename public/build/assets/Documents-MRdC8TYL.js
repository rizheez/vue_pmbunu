import{_ as B,a as F}from"./index-BPQtWMom.js";import{_ as P}from"./AlertTitle.vue_vue_type_script_setup_true_lang-BBBfK5Rz.js";import{_ as Q}from"./index-D2l3Pcwn.js";import{_}from"./index-MlcjGLtN.js";import{_ as S,a as Y,b as tt,c as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-C7Wvf5BJ.js";import{_ as I,a as L,b as N,c as A}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DhnmqUd0.js";import{_ as et}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DhyngyL2.js";import{_ as st}from"./DialogFooter.vue_vue_type_script_setup_true_lang-DlqIMERc.js";import{_ as at}from"./Label.vue_vue_type_script_setup_true_lang-qmueQV-t.js";import{_ as lt}from"./Textarea.vue_vue_type_script_setup_true_lang-h4lxVH3g.js";import{_ as nt}from"./AppLayout.vue_vue_type_script_setup_true_lang-CS0_RWNX.js";import{d as ot,j as it,c as K,p,a as c,e as s,u as e,h as dt,w as n,b as a,k as y,i as h,o as r,f as d,t as u,l as rt,F as E,r as ut,n as mt,s as ct}from"./app-BvkMj4-F.js";import{C as U,F as M}from"./file-text-O4Ei2LhW.js";import{C as pt}from"./circle-alert-C-3yhwGK.js";import{A as ft}from"./arrow-left-CiGTbClU.js";import{C as _t}from"./check-Cti1ODfB.js";import{c as vt}from"./createLucideIcon-C9ErEy5p.js";import{E as gt}from"./eye-BGli4OmQ.js";import{C as bt}from"./circle-x-CSLpUmHv.js";import"./index-BQajbDa3.js";import"./useForwardPropsEmits-Bnkafg18.js";import"./x-BWe9cEwd.js";import"./useForwardExpose-BKrzG8D3.js";import"./VisuallyHidden-z-LB16s1.js";import"./triangle-alert-CapbUlF2.js";import"./index-BHw9BgFF.js";import"./index-CMWG4mbA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-plus-WTRAzdIT.js";const kt=vt("FileImageIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),xt={class:"flex flex-col gap-6 p-4"},yt={class:"flex items-center justify-between"},ht={class:"flex items-center gap-4"},Ct={class:"text-sm text-gray-500"},$t={class:"grid gap-6 md:grid-cols-2 lg:grid-cols-3"},wt={class:"flex items-center justify-between"},zt={key:0,class:"rounded-lg border bg-gray-50 p-4 text-sm"},jt={class:"grid gap-3"},Dt={class:"font-medium"},Vt={class:"grid grid-cols-2 gap-2"},Bt={class:"font-medium font-mono"},Ft={class:"font-medium font-mono"},Pt={class:"grid grid-cols-2 gap-2"},St={class:"font-medium"},Tt={class:"font-medium"},It={class:"font-medium"},Lt=["onClick"],Nt={key:0,class:"flex size-full flex-col items-center justify-center gap-2 bg-gray-50 text-gray-500 transition hover:bg-gray-100"},At=["src","alt"],Kt={class:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 transition hover:opacity-100"},Et={key:2,class:"flex aspect-video items-center justify-center rounded-lg border bg-gray-50"},Ut={key:3,class:"rounded-md border border-red-200 bg-red-50 p-2"},Mt={class:"text-xs text-red-600"},Rt={class:"flex gap-2"},qt={class:"flex-1 max-w-full overflow-hidden rounded-lg bg-gray-100 mt-2"},Ot=["src"],Wt=["src","alt"],Ht={class:"space-y-4 py-4"},Xt={class:"space-y-2"},we=ot({__name:"Documents",props:{student:{}},setup(R){const i=R,q=it(),g=K(()=>q.props.flash),C=p(!1),v=p(!1),$=p(!1),b=p(""),w=p(""),k=p(null),f=p(""),m=p({});(()=>{i.student.student_biodata?.verifications&&i.student.student_biodata.verifications.forEach(o=>{m.value[o.id]={status:o.status,notes:o.notes||""}})})();const O=[{title:"Admin Dashboard",href:"/admin/dashboard"},{title:"Calon Mahasiswa",href:"/admin/students"},{title:i.student.student_biodata?.name||i.student.name,href:`/admin/students/${i.student.id}`},{title:"Verifikasi Dokumen",href:"#"}],z={photo:"Pas Foto",ktp:"KTP",kk:"Kartu Keluarga",certificate:"Ijazah/SKL",biodata:"Biodata Diri"},x=o=>{const t=i.student.student_biodata;return t&&{photo:t.photo_url,ktp:t.ktp_url,kk:t.kk_url,certificate:t.certificate_url}[o]||null},j=o=>({pending:{variant:"outline",label:"Pending",class:"text-yellow-600 border-yellow-300"},approved:{variant:"default",label:"Disetujui",class:"bg-green-600"},rejected:{variant:"destructive",label:"Ditolak",class:""}})[o]||{variant:"secondary",label:"Unknown",class:""},W=(o,t)=>{b.value=o,w.value=t,$.value=!0},H=o=>{k.value=o,f.value=m.value[o]?.notes||"",v.value=!0},X=()=>{k.value&&(m.value[k.value]={status:"rejected",notes:f.value}),v.value=!1,k.value=null,f.value=""},Z=o=>{m.value[o]={status:"approved",notes:""}},G=()=>{const o=Object.entries(m.value).filter(t=>{const[,l]=t;return l.status!=="pending"}).map(([t,l])=>({id:parseInt(t),status:l.status,notes:l.notes}));if(o.length===0){alert("Pilih status verifikasi untuk minimal 1 dokumen");return}C.value=!0,ct.post(`/admin/students/${i.student.id}/documents/bulk-verify`,{verifications:o},{onFinish:()=>{C.value=!1}})},D=o=>o.toLowerCase().endsWith(".pdf")||o.startsWith("data:application/pdf"),J=K(()=>Object.values(m.value).some(o=>o.status!=="pending"));return(o,t)=>(r(),c(E,null,[s(e(dt),{title:`Verifikasi Dokumen - ${i.student.name}`},null,8,["title"]),s(nt,{breadcrumbs:O},{default:n(()=>[a("div",xt,[g.value?.success?(r(),y(e(B),{key:0,class:"border-green-500 bg-green-50"},{default:n(()=>[s(e(U),{class:"size-4 text-green-600"}),s(e(P),{class:"text-green-800"},{default:n(()=>[...t[4]||(t[4]=[d("Berhasil",-1)])]),_:1}),s(e(F),{class:"text-green-700"},{default:n(()=>[d(u(g.value.success),1)]),_:1})]),_:1})):h("",!0),g.value?.error?(r(),y(e(B),{key:1,variant:"destructive"},{default:n(()=>[s(e(pt),{class:"size-4"}),s(e(P),null,{default:n(()=>[...t[5]||(t[5]=[d("Error",-1)])]),_:1}),s(e(F),null,{default:n(()=>[d(u(g.value.error),1)]),_:1})]),_:1})):h("",!0),a("div",yt,[a("div",ht,[s(e(_),{variant:"ghost",size:"sm","as-child":""},{default:n(()=>[s(e(rt),{href:`/admin/students/${i.student.id}`},{default:n(()=>[s(e(ft),{class:"mr-2 size-4"}),t[6]||(t[6]=d(" Kembali ",-1))]),_:1},8,["href"])]),_:1}),a("div",null,[t[7]||(t[7]=a("h1",{class:"text-2xl font-bold"},"Verifikasi Dokumen",-1)),a("p",Ct,u(i.student.student_biodata?.name||i.student.name),1)])]),s(e(_),{onClick:G,disabled:!J.value||C.value,class:"bg-teal-600 hover:bg-teal-700"},{default:n(()=>[s(e(_t),{class:"mr-2 size-4"}),t[8]||(t[8]=d(" Simpan Verifikasi ",-1))]),_:1},8,["disabled"])]),a("div",$t,[(r(!0),c(E,null,ut(i.student.student_biodata?.verifications,l=>(r(),y(e(S),{key:l.id},{default:n(()=>[s(e(Y),{class:"pb-3"},{default:n(()=>[a("div",wt,[s(e(tt),{class:"flex items-center gap-2 text-base"},{default:n(()=>[s(e(kt),{class:"size-4"}),d(" "+u(z[l.document_type]||l.document_type),1)]),_:2},1024),s(e(Q),{variant:j(m.value[l.id]?.status||l.status).variant,class:mt(j(m.value[l.id]?.status||l.status).class)},{default:n(()=>[d(u(j(m.value[l.id]?.status||l.status).label),1)]),_:2},1032,["variant","class"])])]),_:2},1024),s(e(T),{class:"space-y-4"},{default:n(()=>[l.document_type==="biodata"?(r(),c("div",zt,[a("div",jt,[a("div",null,[t[9]||(t[9]=a("span",{class:"text-xs text-gray-500"},"Nama Lengkap",-1)),a("p",Dt,u(i.student.student_biodata?.name),1)]),a("div",Vt,[a("div",null,[t[10]||(t[10]=a("span",{class:"text-xs text-gray-500"},"NIK",-1)),a("p",Bt,u(i.student.student_biodata?.nik),1)]),a("div",null,[t[11]||(t[11]=a("span",{class:"text-xs text-gray-500"},"NISN",-1)),a("p",Ft,u(i.student.student_biodata?.nisn||"-"),1)])]),a("div",Pt,[a("div",null,[t[12]||(t[12]=a("span",{class:"text-xs text-gray-500"},"Tempat, Tgl Lahir",-1)),a("p",St,u(i.student.student_biodata?.birth_place)+", "+u(i.student.student_biodata?.birth_date),1)]),a("div",null,[t[13]||(t[13]=a("span",{class:"text-xs text-gray-500"},"Agama",-1)),a("p",Tt,u(i.student.student_biodata?.religion),1)])]),a("div",null,[t[14]||(t[14]=a("span",{class:"text-xs text-gray-500"},"Asal Sekolah",-1)),a("p",It,u(i.student.student_biodata?.school_origin),1)])])])):x(l.document_type)?(r(),c("div",{key:1,class:"relative aspect-video cursor-pointer overflow-hidden rounded-lg border bg-gray-100",onClick:V=>W(x(l.document_type),z[l.document_type])},[D(x(l.document_type))?(r(),c("div",Nt,[s(e(M),{class:"size-12 text-red-500"}),t[15]||(t[15]=a("span",{class:"text-xs font-medium"},"Dokumen PDF",-1))])):(r(),c("img",{key:1,src:x(l.document_type),alt:z[l.document_type],class:"size-full object-cover transition hover:scale-105"},null,8,At)),a("div",Kt,[s(e(gt),{class:"size-8 text-white"})])],8,Lt)):(r(),c("div",Et,[...t[16]||(t[16]=[a("p",{class:"text-sm text-gray-400"},"Tidak ada file",-1)])])),m.value[l.id]?.status==="rejected"&&m.value[l.id]?.notes?(r(),c("div",Ut,[a("p",Mt,[t[17]||(t[17]=a("strong",null,"Catatan:",-1)),d(" "+u(m.value[l.id].notes),1)])])):h("",!0),a("div",Rt,[s(e(_),{size:"sm",variant:"outline",class:"flex-1 border-green-300 text-green-600 hover:bg-green-50",onClick:V=>Z(l.id),disabled:m.value[l.id]?.status==="approved"},{default:n(()=>[s(e(U),{class:"mr-1 size-4"}),t[18]||(t[18]=d(" Setuju ",-1))]),_:1},8,["onClick","disabled"]),s(e(_),{size:"sm",variant:"outline",class:"flex-1 border-red-300 text-red-600 hover:bg-red-50",onClick:V=>H(l.id)},{default:n(()=>[s(e(bt),{class:"mr-1 size-4"}),t[19]||(t[19]=d(" Tolak ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),i.student.student_biodata?.verifications?.length?h("",!0):(r(),y(e(S),{key:2},{default:n(()=>[s(e(T),{class:"py-12 text-center"},{default:n(()=>[s(e(M),{class:"mx-auto size-12 text-gray-300"}),t[20]||(t[20]=a("p",{class:"mt-4 text-gray-500"},"Belum ada dokumen yang perlu diverifikasi",-1))]),_:1})]),_:1}))]),s(e(I),{open:$.value,"onUpdate:open":t[0]||(t[0]=l=>$.value=l)},{default:n(()=>[s(e(L),{class:"max-w-7xl h-[90vh] flex flex-col"},{default:n(()=>[s(e(N),null,{default:n(()=>[s(e(A),null,{default:n(()=>[d(u(w.value),1)]),_:1})]),_:1}),a("div",qt,[D(b.value)?(r(),c("iframe",{key:0,src:b.value,class:"size-full",frameborder:"0"},null,8,Ot)):(r(),c("img",{key:1,src:b.value,alt:w.value,class:"size-full object-contain"},null,8,Wt))])]),_:1})]),_:1},8,["open"]),s(e(I),{open:v.value,"onUpdate:open":t[3]||(t[3]=l=>v.value=l)},{default:n(()=>[s(e(L),null,{default:n(()=>[s(e(N),null,{default:n(()=>[s(e(A),null,{default:n(()=>[...t[21]||(t[21]=[d("Tolak Dokumen",-1)])]),_:1}),s(e(et),null,{default:n(()=>[...t[22]||(t[22]=[d(" Berikan catatan untuk calon mahasiswa ",-1)])]),_:1})]),_:1}),a("div",Ht,[a("div",Xt,[s(e(at),null,{default:n(()=>[...t[23]||(t[23]=[d("Catatan Penolakan *",-1)])]),_:1}),s(e(lt),{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),rows:"3",placeholder:"Contoh: Foto tidak jelas, mohon upload ulang dengan resolusi lebih baik"},null,8,["modelValue"])])]),s(e(st),null,{default:n(()=>[s(e(_),{variant:"outline",onClick:t[2]||(t[2]=l=>v.value=!1)},{default:n(()=>[...t[24]||(t[24]=[d("Batal",-1)])]),_:1}),s(e(_),{variant:"destructive",onClick:X,disabled:!f.value},{default:n(()=>[...t[25]||(t[25]=[d(" Tolak ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{we as default};
